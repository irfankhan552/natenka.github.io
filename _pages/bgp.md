---
permalink: /bgp/
title: Джентльменский набор для работы с BGP
comments: true
share: true
---

## Джентльменский набор для работы с BGP

Введение
<img align="right" src="https://raw.githubusercontent.com/natenka/natenka.github.io/master/assets/images/bgp/logo_selection_big_tools.png" width="200">

 
BGP (Border Gateway Protocol) — это основной протокол динамической маршрутизации, который используется в Интернет.
 
BGP оперирует большими объемами данных (текущий размер таблицы для IPv4 порядка 450-500 тысяч маршрутов) и принципы его настройки и работы отличаются от внутренних протоколов динамической маршрутизации (IGP).
 
В локальных сетях наибольшее значение имеет скорость сходимости сети, время реагирования на изменения. И маршрутизаторы, которые используют внутренние протоколы динамической маршрутизации, при выборе маршрута, как правило, сравнивают какие-то технические характеристики пути, например, пропускную способность линков.
 
Но при выборе между каналами двух провайдеров, зачастую имеет значение не то, у какого канала лучше технические характеристики, а какие-то внутренние правила компании. Например, использование какого канала обходится компании дешевле. Поэтому в BGP выбор лучшего маршрута осуществляется на основании политик, которые настраиваются с использованием фильтров, анонсирования маршрутов, и изменения атрибутов.
 
Маршрутизаторы, использующие протокол BGP, обмениваются информацией о доступности сетей. Вместе с информацией о сетях передаются различные атрибуты этих сетей, с помощью которых BGP выбирает лучший маршрут и настраиваются политики маршрутизации.
 
Один из основных атрибутов, который передается с информацией о маршруте — это список автономных систем, через которые прошла эта информация. Это информация позволяет BGP определять где находится сеть относительно автономных систем, исключать петли маршрутизации, а также может быть использована при настройке политик.
 
Маршрутизация осуществляется пошагово от одной автономной системы к другой, согласно тем политикам, которые в них настроены. Все политики BGP настраиваются, в основном, по отношению к внешним/соседним автономным системам. То есть, описываются правила взаимодействия с ними.
 
Так как в задачи статьи не входит детальное описание принципов работы BGP, остановимся на этом кратком описании.
 
В конце статьи все утилиты, ресурсы и сайты со статистикой, которые использовались в статье, перечислены с кратким описанием. Там же даны пояснения некоторым терминам.
 
В ходе статьи, утилиты и статистическая информация, будут рассматриваться на примерах, для того чтобы было понятней в каких случаях они могут быть использованы.
 
Вся статистика, которая приведена в статье, актуальна на момент написания статьи и может отличаться при просмотре в последующие дни.
 
 
### Общая статистика BGP
 
При изучении и настройке BGP очень полезными могут быть различные утилиты и статистические данные.
 
С точки зрения изучения BGP, они позволяют лучше понять как работает протокол, как выбираются маршруты, какая текущая ситуация в Интернет с точки зрения различной статистики.
 
Например, первое, что, как правило, встречается при описании основ BGP, это то, что BGP работает между автономными системами.

![time](https://raw.githubusercontent.com/natenka/natenka.github.io/master/assets/images/bgp/1_bgp.png)

Рисунок 1. С точки зрения BGP Интернет выглядит как множество соединенных между собой автономных систем.
 
На рисунке 1 изображена небольшая часть сети, относительно автономной системы 60953, которая будет использоваться в примерах (эта схема сгенерирована утилитой BGPlay).
 
Каждая автономная система, которая обозначена на схеме, на самом деле внутри состоит из множества маршрутизаторов (цветовые обозначениях, которые используются в схеме, будут объяснены далее).
 
Для того чтобы немного лучше понимать масштабы работы BGP, далее приведено немного общей статистики.
 
Количество префиксов и автономных систем с которыми работает BGP:

